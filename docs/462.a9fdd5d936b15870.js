"use strict";(self.webpackChunkwhat_do_you_meme=self.webpackChunkwhat_do_you_meme||[]).push([[462],{2462:(ft,$,c)=>{c.r($),c.d($,{GalleryModule:()=>w});var f=c(6895),l=c(4650),z=c(138),R=c(1135),E=c(529);class T{constructor(t){this.http=t,this.SERVER_URL=z.E.SERVER_URL,this.downloadItems$$=new R.X([]),this.downloadItems$=this.downloadItems$$.asObservable(),this.galleryCards$$=new R.X([]),this.galleryCards$=this.galleryCards$$.asObservable(),this.chunkOptions={page:0,limit:12}}get galleryItemsRequest(){return this.http.get(`${this.SERVER_URL}/file/images/meme`).subscribe(t=>{this.galleryItems=t,this.updateGalleryList()})}get page(){return this.chunkOptions.page}get limit(){return this.chunkOptions.limit}getChunk(t){return t.slice(this.page*this.limit,(this.page+1)*this.limit)}incrementPage(){++this.chunkOptions.page}decrementPage(){--this.chunkOptions.page}clearDownloadItems(){this.downloadItems$$.next([])}addToDownloadItems(t){this.downloadItems$$.next([...this.downloadItems$$.value,t])}removeFromDownloadList(t){this.downloadItems$$.next(this.downloadItems$$.value.filter(e=>e!==t))}downloadItemsArr(){return this.http.post(`${this.SERVER_URL}/file/images/meme/zip`,this.downloadItems$$.value,{responseType:"blob",observe:"body"})}updateGalleryList(){this.galleryCards$$.next([...this.galleryCards$$.value,...this.getChunk(this.galleryItems)])}}T.\u0275fac=function(t){return new(t||T)(l.LFG(E.eN))},T.\u0275prov=l.Yz7({token:T,factory:T.\u0275fac,providedIn:"root"});var L=c(4859);class _{constructor(t){this.galleryService=t,this.downloadItems$=this.galleryService.downloadItems$}clearDownloadItems(){this.galleryService.clearDownloadItems()}downloadItems(){this.galleryService.downloadItemsArr().subscribe(t=>{window.location.href=URL.createObjectURL(t)}),this.galleryService.clearDownloadItems()}}_.\u0275fac=function(t){return new(t||_)(l.Y36(T))},_.\u0275cmp=l.Xpm({type:_,selectors:[["app-gallery-controls"]],decls:7,vars:5,consts:[[1,"gallery__controls"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","warn",3,"click"]],template:function(t,e){if(1&t&&(l.TgZ(0,"div",0)(1,"button",1),l.NdJ("click",function(){return e.downloadItems()}),l._uU(2),l.ALo(3,"async"),l.ALo(4,"async"),l.qZA(),l.TgZ(5,"button",2),l.NdJ("click",function(){return e.clearDownloadItems()}),l._uU(6,"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c"),l.qZA()()),2&t){let o;l.xp6(2),l.hij("\u0421\u043a\u0430\u0447\u0430\u0442\u044c ",0===(null==(o=l.lcZ(3,1,e.downloadItems$))?null:o.length)?"\u0432\u0441\u0435":(null==(o=l.lcZ(4,3,e.downloadItems$))?null:o.length)+" \u0444\u0430\u0439\u043b(-\u0430/-\u043e\u0432)"," ")}},dependencies:[L.lW,f.Ov],styles:[".gallery__controls[_ngcontent-%COMP%]{position:sticky;top:0;display:flex;justify-content:space-between;padding:20px;border-radius:13px;background-color:#1b1a20;z-index:2}"]});var A=c(7296),O=c(4004),U=c(5174);function k(s,t){if(1&s){const e=l.EpF();l.TgZ(0,"button",4),l.NdJ("click",function(){l.CHM(e);const u=l.oxw();return l.KtG(u.addToDownloadList())}),l._uU(1,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),l.qZA()}}function N(s,t){if(1&s){const e=l.EpF();l.TgZ(0,"button",5),l.NdJ("click",function(){l.CHM(e);const u=l.oxw();return l.KtG(u.addToDownloadList())}),l._uU(1,"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"),l.qZA()}}class M{constructor(t){this.galleryService=t,this.isAdded$=this.galleryService.downloadItems$.pipe((0,O.U)(e=>this.isAdded=e.some(o=>o===this.item)))}addToDownloadList(){this.isAdded?this.galleryService.removeFromDownloadList(this.item):this.galleryService.addToDownloadItems(this.item)}}function W(s,t){1&s&&l._UZ(0,"app-gallery-item",2),2&s&&l.Q6J("item",t.$implicit)}M.\u0275fac=function(t){return new(t||M)(l.Y36(T))},M.\u0275cmp=l.Xpm({type:M,selectors:[["app-gallery-item"]],inputs:{item:"item"},decls:6,vars:7,consts:[[1,"gallery__item"],[1,"gallery__card",3,"appImage"],["class","gallery__btn","mat-raised-button","","color","accent",3,"click",4,"ngIf"],["class","gallery__btn","mat-raised-button","","color","warn",3,"click",4,"ngIf"],["mat-raised-button","","color","accent",1,"gallery__btn",3,"click"],["mat-raised-button","","color","warn",1,"gallery__btn",3,"click"]],template:function(t,e){1&t&&(l.TgZ(0,"li",0),l._UZ(1,"div",1),l.YNc(2,k,2,0,"button",2),l.ALo(3,"async"),l.YNc(4,N,2,0,"button",3),l.ALo(5,"async"),l.qZA()),2&t&&(l.xp6(1),l.Q6J("appImage",e.item),l.xp6(1),l.Q6J("ngIf",!l.lcZ(3,3,e.isAdded$)),l.xp6(2),l.Q6J("ngIf",l.lcZ(5,5,e.isAdded$)))},dependencies:[f.O5,L.lW,U.t,f.Ov],styles:[".gallery__item[_ngcontent-%COMP%]{padding:20px;border-radius:13px;background-color:#1b1a20;overflow:hidden}.gallery__card[_ngcontent-%COMP%]{width:320px;height:320px;margin-bottom:20px;border-radius:5px;background-size:cover;background-repeat:no-repeat;background-position:center;text-align:center}.gallery__btn[_ngcontent-%COMP%]{display:block;margin:0 auto}"]});class I{constructor(t){this.galleryService=t,this.scrollOptions={scrollUpDistance:16,scrollDistance:16,throttle:4},this.galleryCards$=this.galleryService.galleryCards$}ngOnInit(){}onScrollDown(){this.galleryService.incrementPage(),this.galleryService.updateGalleryList()}onScrollUp(){this.galleryService.decrementPage()}}I.\u0275fac=function(t){return new(t||I)(l.Y36(T))},I.\u0275cmp=l.Xpm({type:I,selectors:[["app-gallery-list"]],decls:3,vars:6,consts:[["infinite-scroll","",1,"gallery__list",3,"infiniteScrollDistance","infiniteScrollUpDistance","infiniteScrollThrottle","scrolled","scrolledUp"],[3,"item",4,"ngFor","ngForOf"],[3,"item"]],template:function(t,e){1&t&&(l.TgZ(0,"ul",0),l.NdJ("scrolled",function(){return e.onScrollDown()})("scrolledUp",function(){return e.onScrollUp()}),l.YNc(1,W,1,1,"app-gallery-item",1),l.ALo(2,"async"),l.qZA()),2&t&&(l.Q6J("infiniteScrollDistance",e.scrollOptions.scrollDistance)("infiniteScrollUpDistance",e.scrollOptions.scrollUpDistance)("infiniteScrollThrottle",e.scrollOptions.throttle),l.xp6(1),l.Q6J("ngForOf",l.lcZ(2,4,e.galleryCards$)))},dependencies:[f.sg,A.Ry,M,f.Ov],styles:[".gallery__list[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:40px;margin:20px 0}"]});class x{}x.\u0275fac=function(t){return new(t||x)},x.\u0275cmp=l.Xpm({type:x,selectors:[["app-gallery-page"]],decls:5,vars:0,consts:[[1,"gallery"],[1,"container"],[1,"gallery__wrapper"]],template:function(t,e){1&t&&(l.TgZ(0,"section",0)(1,"div",1)(2,"div",2),l._UZ(3,"app-gallery-controls")(4,"app-gallery-list"),l.qZA()()())},dependencies:[_,I]});var j=c(6259),b=c(433),K=c(793),Z=c(4466),D=c(3238);let dt=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=l.oAB({type:s}),s.\u0275inj=l.cJS({imports:[D.uc,D.BQ,D.uc,D.BQ]}),s})();class w{}w.\u0275fac=function(t){return new(t||w)},w.\u0275mod=l.oAB({type:w}),w.\u0275inj=l.cJS({imports:[f.ez,b.UX,K.q,j.Bz.forChild([{path:"",pathMatch:"full",component:x}]),A.Rq,Z.m,dt]})},7296:(ft,$,c)=>{c.d($,{Ry:()=>m,Rq:()=>ht});var f=c(4650),l=c(9646),z=c(4968),R=c(5577),E=c(4004),T=c(8505),L=c(9300),_=c(4986),A=c(4482),O=c(5403),U=c(8421);const k={leading:!0,trailing:!1};var M=c(2805);function x(i,n,r,a){const d=window&&!!window.document&&window.document.documentElement;let h=d&&n?window:r;if(i&&(h=i&&d&&"string"==typeof i?function j(i,n,r){return(r?window.document:n).querySelector(i)}(i,r.nativeElement,a):i,!h))throw new Error("ngx-infinite-scroll {resolveContainerElement()}: selector for");return h}function b(i){return i&&!i.firstChange}const Z={clientHeight:"clientHeight",offsetHeight:"offsetHeight",scrollHeight:"scrollHeight",pageYOffset:"pageYOffset",offsetTop:"offsetTop",scrollTop:"scrollTop",top:"top"},D={clientHeight:"clientWidth",offsetHeight:"offsetWidth",scrollHeight:"scrollWidth",pageYOffset:"pageXOffset",offsetTop:"offsetLeft",scrollTop:"scrollLeft",top:"left"};class q{constructor(n=!0){this.vertical=n,this.propsMap=n?Z:D}clientHeightKey(){return this.propsMap.clientHeight}offsetHeightKey(){return this.propsMap.offsetHeight}scrollHeightKey(){return this.propsMap.scrollHeight}pageYOffsetKey(){return this.propsMap.pageYOffset}offsetTopKey(){return this.propsMap.offsetTop}scrollTopKey(){return this.propsMap.scrollTop}topKey(){return this.propsMap.top}}function nt(i){return["Window","global"].some(r=>Object.prototype.toString.call(i).includes(r))}function H(i,n){return i?n.document.documentElement:null}function B(i,n){const r=function ot({container:i,isWindow:n,axis:r}){const{offsetHeightKey:a,clientHeightKey:d}=Y(r);return Q(i,n,a,d)}(n);return n.isWindow?function lt(i,n,r){const{axis:a,container:d,isWindow:h}=r,{offsetHeightKey:g,clientHeightKey:S}=Y(a),p=i+J(H(h,d),a,h),y=Q(n.nativeElement,h,g,S),C=function V(i,n,r){const a=n.topKey();if(i.getBoundingClientRect)return i.getBoundingClientRect()[a]+J(i,n,r)}(n.nativeElement,a,h)+y;return{height:i,scrolled:p,totalToScroll:C,isWindow:h}}(r,i,n):function rt(i,n,r){const{axis:a,container:d}=r;return{height:i,scrolled:d[a.scrollTopKey()],totalToScroll:d[a.scrollHeightKey()],isWindow:!1}}(r,0,n)}function Y(i){return{offsetHeightKey:i.offsetHeightKey(),clientHeightKey:i.clientHeightKey()}}function Q(i,n,r,a){if(isNaN(i[r])){const d=H(n,i);return d?d[a]:0}return i[r]}function J(i,n,r){const a=n.pageYOffsetKey(),d=n.scrollTopKey(),h=n.offsetTopKey();return isNaN(window.pageYOffset)?H(r,i)[d]:i.ownerDocument?i.ownerDocument.defaultView[a]:i[h]}function st(i,n={down:0,up:0},r){let a,d;if(i.totalToScroll<=0)return!1;const h=i.isWindow?i.scrolled:i.height+i.scrolled;return r?(a=(i.totalToScroll-h)/i.totalToScroll,d=(n?.down?n.down:0)/10):(a=i.scrolled/(i.scrolled+(i.totalToScroll-h)),d=(n?.up?n.up:0)/10),a<=d}class w{constructor({totalToScroll:n}){this.lastScrollPosition=0,this.lastTotalToScroll=0,this.totalToScroll=0,this.triggered={down:0,up:0},this.totalToScroll=n}updateScrollPosition(n){return this.lastScrollPosition=n}updateTotalToScroll(n){this.lastTotalToScroll!==n&&(this.lastTotalToScroll=this.totalToScroll,this.totalToScroll=n)}updateScroll(n,r){this.updateScrollPosition(n),this.updateTotalToScroll(r)}updateTriggeredFlag(n,r){r?this.triggered.down=n:this.triggered.up=n}isTriggeredScroll(n,r){return r?this.triggered.down===n:this.triggered.up===n}}function s(i){const{scrollContainer:n,scrollWindow:r,element:a,fromRoot:d}=i,h=function et({windowElement:i,axis:n}){return function it(i,n){const r=i.isWindow||n&&!n.nativeElement?n:n.nativeElement;return{...i,container:r}}({axis:n,isWindow:nt(i)},i)}({axis:new q(!i.horizontal),windowElement:x(n,r,a,d)}),g=new w({totalToScroll:B(a,h)}),p={up:i.upDistance,down:i.downDistance};return function t(i){let n=(0,z.R)(i.container,"scroll");return i.throttle&&(n=n.pipe(function W(i,n=_.z,r=k){const a=(0,M.H)(i,n);return function N(i,n=k){return(0,A.e)((r,a)=>{const{leading:d,trailing:h}=n;let g=!1,S=null,p=null,y=!1;const C=()=>{p?.unsubscribe(),p=null,h&&(gt(),y&&a.complete())},X=()=>{p=null,y&&a.complete()},ut=G=>p=(0,U.Xf)(i(G)).subscribe((0,O.x)(a,C,X)),gt=()=>{if(g){g=!1;const G=S;S=null,a.next(G),!y&&ut(G)}};r.subscribe((0,O.x)(a,G=>{g=!0,S=G,(!p||p.closed)&&(d?gt():ut(G))},()=>{y=!0,(!(h&&g&&p)||p.closed)&&a.complete()}))})}(()=>a,r)}(i.throttle,void 0,{leading:!0,trailing:!0}))),n}({container:h.container,throttle:i.throttle}).pipe((0,R.z)(()=>(0,l.of)(B(a,h))),(0,E.U)(y=>function e(i,n,r){const{scrollDown:a,fire:d}=function ct(i,n,r){const a=function at(i,n){return i<n.scrolled}(i,n);return{fire:st(n,r,a),scrollDown:a}}(i,n,r);return{scrollDown:a,fire:d,stats:n}}(g.lastScrollPosition,y,p)),(0,T.b)(({stats:y})=>g.updateScroll(y.scrolled,y.totalToScroll)),(0,L.h)(({fire:y,scrollDown:C,stats:{totalToScroll:X}})=>function tt(i,n,r){return!!(i&&n||!r&&n)}(i.alwaysCallback,y,g.isTriggeredScroll(X,C))),(0,T.b)(({scrollDown:y,stats:{totalToScroll:C}})=>{g.updateTriggeredFlag(C,y)}),(0,E.U)(u))}function u(i){const{scrollDown:n,stats:{scrolled:r}}=i;return{type:n?"[NGX_ISE] DOWN":"[NGX_ISE] UP",payload:{currentScrollPosition:r}}}let m=(()=>{class i{constructor(r,a){this.element=r,this.zone=a,this.scrolled=new f.vpe,this.scrolledUp=new f.vpe,this.infiniteScrollDistance=2,this.infiniteScrollUpDistance=1.5,this.infiniteScrollThrottle=150,this.infiniteScrollDisabled=!1,this.infiniteScrollContainer=null,this.scrollWindow=!0,this.immediateCheck=!1,this.horizontal=!1,this.alwaysCallback=!1,this.fromRoot=!1}ngAfterViewInit(){this.infiniteScrollDisabled||this.setup()}ngOnChanges({infiniteScrollContainer:r,infiniteScrollDisabled:a,infiniteScrollDistance:d}){const h=b(r),g=b(a),S=b(d),p=!g&&!this.infiniteScrollDisabled||g&&!a.currentValue||S;(h||g||S)&&(this.destroyScroller(),p&&this.setup())}setup(){(function K(){return typeof window<"u"})()&&this.zone.runOutsideAngular(()=>{this.disposeScroller=s({fromRoot:this.fromRoot,alwaysCallback:this.alwaysCallback,disable:this.infiniteScrollDisabled,downDistance:this.infiniteScrollDistance,element:this.element,horizontal:this.horizontal,scrollContainer:this.infiniteScrollContainer,scrollWindow:this.scrollWindow,throttle:this.infiniteScrollThrottle,upDistance:this.infiniteScrollUpDistance}).subscribe(r=>this.handleOnScroll(r))})}handleOnScroll({type:r,payload:a}){const d="[NGX_ISE] DOWN"===r?this.scrolled:this.scrolledUp;(function P(i){return i.observed??i.observers.length>0})(d)&&this.zone.run(()=>d.emit(a))}ngOnDestroy(){this.destroyScroller()}destroyScroller(){this.disposeScroller&&this.disposeScroller.unsubscribe()}}return i.\u0275fac=function(r){return new(r||i)(f.Y36(f.SBq),f.Y36(f.R0b))},i.\u0275dir=f.lG2({type:i,selectors:[["","infiniteScroll",""],["","infinite-scroll",""],["","data-infinite-scroll",""]],inputs:{infiniteScrollDistance:"infiniteScrollDistance",infiniteScrollUpDistance:"infiniteScrollUpDistance",infiniteScrollThrottle:"infiniteScrollThrottle",infiniteScrollDisabled:"infiniteScrollDisabled",infiniteScrollContainer:"infiniteScrollContainer",scrollWindow:"scrollWindow",immediateCheck:"immediateCheck",horizontal:"horizontal",alwaysCallback:"alwaysCallback",fromRoot:"fromRoot"},outputs:{scrolled:"scrolled",scrolledUp:"scrolledUp"},features:[f.TTD]}),i})(),ht=(()=>{class i{}return i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=f.oAB({type:i}),i.\u0275inj=f.cJS({}),i})()}}]);